{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { getFileSizeAndUnit, isEmpty } from '@utils/helpers';\nimport React, { useState, useEffect, useRef } from 'react';\nimport { toast as toaster } from 'react-toastify';\nvar initialState = {\n  files: [],\n  events: [],\n  filePreviews: {},\n  uploading: false,\n  selectedFile: null,\n  loaded: 0,\n  error: '',\n  warning: '',\n  content: ''\n};\nexport default function UploadComponent(_ref) {\n  _s();\n\n  var _ref$autoUpload = _ref.autoUpload,\n      autoUpload = _ref$autoUpload === void 0 ? true : _ref$autoUpload,\n      _ref$allowedExtension = _ref.allowedExtensions,\n      allowedExtensions = _ref$allowedExtension === void 0 ? ['.doc', '.docx', '.xls', '.xlsx', '.pdf', '.svg', 'image/png', 'image/jpeg', 'image/gif', 'image/*', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'] : _ref$allowedExtension,\n      _ref$maxFileSize = _ref.maxFileSize,\n      maxFileSize = _ref$maxFileSize === void 0 ? 40000000 : _ref$maxFileSize,\n      disabled = _ref.disabled,\n      _ref$className = _ref.className,\n      className = _ref$className === void 0 ? '' : _ref$className,\n      render = _ref.render,\n      refreshCallback = _ref.refreshCallback,\n      uploadHandler = _ref.uploadHandler;\n\n  var _useState = useState(initialState),\n      state = _useState[0],\n      setState = _useState[1];\n\n  var _useState2 = useState(false),\n      runAutoUpload = _useState2[0],\n      setAutoUpload = _useState2[1];\n\n  var _useState3 = useState(false),\n      load = _useState3[0],\n      reload = _useState3[1];\n\n  function updateState(update) {\n    var newState = _objectSpread(_objectSpread({}, state), update);\n\n    setState(newState);\n    refreshCallback && refreshCallback(newState);\n    return newState;\n  }\n\n  var toast = {\n    warn: function warn(msg) {\n      toaster.warn(msg);\n      updateState({\n        error: msg\n      });\n    },\n    error: function error(msg) {\n      toaster.error(msg);\n      updateState({\n        error: msg\n      });\n    },\n    success: function success(msg) {\n      toaster.success(msg);\n      updateState({\n        error: ''\n      });\n    }\n  };\n\n  var checkMimeType = function checkMimeType(files, resetField) {\n    var err = [];\n    var types = allowedExtensions;\n\n    var _loop = function _loop(x) {\n      if (types.every(function (type) {\n        var _files$x;\n\n        return ((_files$x = files[x]) === null || _files$x === void 0 ? void 0 : _files$x.type) !== type;\n      })) {\n        err[x] = files[x].type + ' is not a supported format\\n';\n      }\n    };\n\n    for (var x = 0; x < files.length; x++) {\n      _loop(x);\n    }\n\n    for (var z = 0; z < err.length; z++) {\n      toast.error(err[z]);\n      resetField && resetField();\n    }\n\n    if (!isEmpty(err)) return false;\n    return true;\n  };\n\n  var maxSelectFile = function maxSelectFile(files, resetField) {\n    var maxLength = 1;\n\n    if (files.length > maxLength) {\n      var msg = \"Only \".concat(maxLength, \" file can be uploaded at a time\");\n      resetField && resetField();\n      toast.warn(msg);\n      return false;\n    }\n\n    return true;\n  };\n\n  var checkFileSize = function checkFileSize(files, resetField) {\n    //  default max size is 2.05GB\n    var size = maxFileSize || 20000000;\n    var err = [];\n\n    for (var x = 0; x < files.length; x++) {\n      if (files[x].size > size) {\n        err[x] = files[x].type + ' is too large, please pick a smaller file\\n' + \"Max size: \".concat(getFileSizeAndUnit(size));\n      }\n    }\n\n    for (var z = 0; z < err.length; z++) {\n      toast.error(err[z]);\n      resetField && resetField();\n    }\n\n    if (!isEmpty(err)) return false;\n    return true;\n  };\n\n  var readFile = function readFile(file) {\n    var currentIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var lState = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : state;\n    var validateFile = arguments.length > 3 ? arguments[3] : undefined;\n\n    // run validations if any\n    if (validateFile) {\n      validateFile(file);\n    }\n\n    var files = lState.files;\n    var reader = new FileReader();\n    reader.addEventListener('load', function (event) {\n      if (event.target) {\n        var filesData = {\n          url: event.target.result,\n          meta: Array.from(lState.selectedFile)[currentIndex],\n          loaded: files[currentIndex] ? files[currentIndex].loaded : 0\n        };\n        var newfileUpdate = files;\n        newfileUpdate[currentIndex] = filesData;\n        updateState({\n          files: newfileUpdate,\n          selectedFile: lState.selectedFile\n        });\n      }\n    });\n    reader.readAsDataURL(file);\n  };\n\n  var onChangeHandler = function onChangeHandler(event) {\n    var files = event.target.files;\n\n    var resetField = function resetField() {\n      return event.target.value = '';\n    };\n\n    if (files) {\n      if (maxSelectFile(files, resetField) && checkMimeType(files, resetField) && checkFileSize(files, resetField)) {\n        // if return true allow to setState\n        var newState = updateState({\n          selectedFile: files,\n          loaded: 0\n        });\n        Array.from(files).forEach(function (fl, index) {\n          return readFile(fl, index, newState);\n        });\n\n        if (autoUpload) {\n          setAutoUpload(true);\n        }\n      }\n    }\n  };\n\n  var handleUpload = function handleUpload(data, state, cb) {\n    if (uploadHandler) uploadHandler(data, state, cb);\n  };\n\n  var onClickHandler = function onClickHandler() {\n    var newState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : state;\n\n    try {\n      var selectedFile = newState.selectedFile;\n\n      var _data = new FormData();\n\n      if (!isEmpty(selectedFile)) {\n        for (var x = 0; x < selectedFile.length; x++) {\n          _data.append('file', selectedFile[x]);\n        }\n\n        handleUpload(_data, newState, updateState);\n      }\n    } catch (err) {\n      console.log('err', err);\n    } finally {\n      setAutoUpload(false);\n    }\n  };\n\n  var uploadArea = useRef(null);\n  var uploadDomRef = useRef(null);\n  var dc = useRef(null);\n  var uploadDom = '#common-upload-component';\n  useEffect(function () {\n    dc.current = document;\n    uploadArea.current = document.querySelector(uploadDom);\n    if (runAutoUpload) onClickHandler(state); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [runAutoUpload]);\n\n  var getUploadArea = function getUploadArea() {\n    if (dc.current) return dc.current.querySelector(uploadDom);else if (dc.current) return uploadArea.current;else if (uploadDomRef.current) return uploadDomRef.current;else if (!load) reload(true);\n  };\n\n  return __jsx(\"div\", {\n    id: \"drop-area\",\n    className: \"pt-4 relative \".concat(className),\n    style: {\n      minHeight: '50px'\n    }\n  }, __jsx(\"div\", {\n    className: \"container hidden\"\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"offset-md-3 col-md-6\"\n  }, __jsx(\"div\", {\n    className: \"form-group files\"\n  }, __jsx(\"label\", null, \"Upload Your File \"), __jsx(\"input\", {\n    type: \"file\",\n    id: \"common-upload-component\",\n    ref: uploadDomRef,\n    disabled: Boolean(disabled),\n    className: \"form-control\",\n    accept: \"xls, xlsx\",\n    onChange: onChangeHandler\n  })), !autoUpload && __jsx(\"button\", {\n    type: \"button\",\n    className: \"btn btn-success btn-block\",\n    onClick: function onClick() {\n      return onClickHandler();\n    }\n  }, \"Upload\")))), render(getUploadArea()));\n}\n\n_s(UploadComponent, \"N2n6sctpJdl8l6fsTngNJXjE64Y=\");\n\n_c = UploadComponent;\n\nvar _c;\n\n$RefreshReg$(_c, \"UploadComponent\");","map":{"version":3,"sources":["/mnt/c/Users/arash/Documents/DevInDoc/Getaboard/demoEmail/reward-test/src/components/FileUpload.tsx"],"names":["getFileSizeAndUnit","isEmpty","React","useState","useEffect","useRef","toast","toaster","initialState","files","events","filePreviews","uploading","selectedFile","loaded","error","warning","content","UploadComponent","autoUpload","allowedExtensions","maxFileSize","disabled","className","render","refreshCallback","uploadHandler","state","setState","runAutoUpload","setAutoUpload","load","reload","updateState","update","newState","warn","msg","success","checkMimeType","resetField","err","types","x","every","type","length","z","maxSelectFile","maxLength","checkFileSize","size","readFile","file","currentIndex","lState","validateFile","reader","FileReader","addEventListener","event","target","filesData","url","result","meta","Array","from","newfileUpdate","readAsDataURL","onChangeHandler","value","forEach","fl","index","handleUpload","data","cb","onClickHandler","FormData","append","console","log","uploadArea","uploadDomRef","dc","uploadDom","current","document","querySelector","getUploadArea","minHeight","Boolean"],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { getFileSizeAndUnit, isEmpty } from '@utils/helpers'\nimport React, { useState, useEffect, useRef, useMemo } from 'react'\nimport { toast as toaster } from 'react-toastify'\n\ninterface UploadProps {\n  disabled?: boolean\n  autoUpload?: boolean\n  allowedExtensions?: string[]\n  maxFileSize?: number\n  className?: string\n  render: (el: HTMLInputElement | null) => JSX.Element\n  // render: (uploadElement: HTMLElement | null) => JSX.Element\n  refreshCallback?: (data: UploadState) => void\n  uploadHandler?: (\n    data: FormData,\n    state: UploadState,\n    cb: (update: any) => void\n  ) => Promise<boolean> | void\n}\n\ntype UploadState = {\n  files: any[]\n  events: any[]\n  filePreviews: any\n  uploading: boolean\n  content: string\n  selectedFile: any\n  loaded: number\n  warning: string\n  error: string\n}\n\ntype UploadStateOptional = {\n  files?: any[]\n  events?: any[]\n  filePreviews?: any\n  uploading?: boolean\n  content?: string\n  selectedFile?: any\n  loaded?: number\n  warning?: string\n  error?: string\n}\n\nconst initialState: UploadState = {\n  files: [],\n  events: [],\n  filePreviews: {},\n  uploading: false,\n  selectedFile: null,\n  loaded: 0,\n  error: '',\n  warning: '',\n  content: '',\n}\n\nexport default function UploadComponent({\n  autoUpload = true,\n  allowedExtensions = [\n    '.doc',\n    '.docx',\n    '.xls',\n    '.xlsx',\n    '.pdf',\n    '.svg',\n    'image/png',\n    'image/jpeg',\n    'image/gif',\n    'image/*',\n    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  ],\n  maxFileSize = 40000000,\n  disabled,\n  className = '',\n  render,\n  refreshCallback,\n  uploadHandler,\n}: UploadProps) {\n  const [state, setState] = useState<UploadState>(initialState)\n  const [runAutoUpload, setAutoUpload] = useState(false)\n  const [load, reload] = useState(false)\n\n  function updateState(update: UploadStateOptional) {\n    const newState = { ...state, ...update }\n    setState(newState)\n    refreshCallback && refreshCallback(newState)\n    return newState\n  }\n\n  const toast = {\n    warn: (msg: string) => {\n      toaster.warn(msg)\n      updateState({ error: msg })\n    },\n    error: (msg: string) => {\n      toaster.error(msg)\n      updateState({ error: msg })\n    },\n    success: (msg: string) => {\n      toaster.success(msg)\n      updateState({ error: '' })\n    },\n  }\n\n  const checkMimeType = (files: FileList, resetField?: () => void) => {\n    const err = []\n    const types = allowedExtensions\n    for (let x = 0; x < files.length; x++) {\n      if (types.every((type) => files[x]?.type !== type)) {\n        err[x] = files[x].type + ' is not a supported format\\n'\n      }\n    }\n    for (let z = 0; z < err.length; z++) {\n      toast.error(err[z])\n      resetField && resetField()\n    }\n    if (!isEmpty(err)) return false\n    return true\n  }\n\n  const maxSelectFile = (files: FileList, resetField?: () => void) => {\n    const maxLength = 1\n\n    if (files.length > maxLength) {\n      const msg = `Only ${maxLength} file can be uploaded at a time`\n      resetField && resetField()\n      toast.warn(msg)\n      return false\n    }\n    return true\n  }\n\n  const checkFileSize = (files: FileList, resetField?: () => void) => {\n    //  default max size is 2.05GB\n    const size = maxFileSize || 20000000\n    const err = []\n    for (let x = 0; x < files.length; x++) {\n      if (files[x].size > size) {\n        err[x] =\n          files[x].type +\n          ' is too large, please pick a smaller file\\n' +\n          `Max size: ${getFileSizeAndUnit(size)}`\n      }\n    }\n    for (let z = 0; z < err.length; z++) {\n      toast.error(err[z])\n      resetField && resetField()\n    }\n    if (!isEmpty(err)) return false\n    return true\n  }\n\n  const readFile = (\n    file: any,\n    currentIndex = 0,\n    lState: UploadStateOptional = state,\n    validateFile?: (file: any) => any\n  ) => {\n    // run validations if any\n    if (validateFile) {\n      validateFile(file)\n    }\n\n    const files = lState.files\n\n    const reader = new FileReader()\n    reader.addEventListener('load', (event) => {\n      if (event.target) {\n        const filesData: {\n          url: string\n          meta: any\n          loaded: number\n        } = {\n          url: event.target.result as string,\n          meta: Array.from(lState.selectedFile)[currentIndex],\n          loaded: files[currentIndex] ? files[currentIndex].loaded : 0,\n        }\n        const newfileUpdate = files\n        newfileUpdate[currentIndex] = filesData\n        updateState({\n          files: newfileUpdate,\n          selectedFile: lState.selectedFile,\n        })\n      }\n    })\n    reader.readAsDataURL(file)\n  }\n\n  const onChangeHandler:\n    | ((event: React.ChangeEvent<HTMLInputElement>) => void)\n    | undefined = (event) => {\n    const files = event.target.files\n    const resetField = () => (event.target.value = '')\n    if (files) {\n      if (\n        maxSelectFile(files, resetField) &&\n        checkMimeType(files, resetField) &&\n        checkFileSize(files, resetField)\n      ) {\n        // if return true allow to setState\n        const newState = updateState({\n          selectedFile: files,\n          loaded: 0,\n        })\n        Array.from(files).forEach((fl: any, index: number) =>\n          readFile(fl, index, newState)\n        )\n        if (autoUpload) {\n          setAutoUpload(true)\n        }\n      }\n    }\n  }\n\n  const handleUpload = (\n    data: FormData,\n    state: UploadState,\n    cb: (update: any) => void\n  ) => {\n    if (uploadHandler) uploadHandler(data, state, cb)\n  }\n\n  const onClickHandler = (newState: UploadState = state) => {\n    try {\n      const selectedFile = newState.selectedFile\n      const data = new FormData()\n      if (!isEmpty(selectedFile)) {\n        for (let x = 0; x < selectedFile.length; x++) {\n          data.append('file', selectedFile[x])\n        }\n        handleUpload(data, newState, updateState)\n      }\n    } catch (err) {\n      console.log('err', err)\n    } finally {\n      setAutoUpload(false)\n    }\n  }\n\n  const uploadArea = useRef(null)\n  const uploadDomRef = useRef<HTMLInputElement>(null)\n  const dc = useRef(null)\n  const uploadDom = '#common-upload-component'\n\n  useEffect(() => {\n    dc.current = document\n    uploadArea.current = document.querySelector(uploadDom) as HTMLElement\n    if (runAutoUpload) onClickHandler(state)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [runAutoUpload])\n\n  const getUploadArea = () => {\n    if (dc.current) return dc.current.querySelector(uploadDom) as HTMLElement\n    else if (dc.current) return uploadArea.current\n    else if (uploadDomRef.current) return uploadDomRef.current\n    else if (!load) reload(true)\n  }\n\n  return (\n    <div\n      id=\"drop-area\"\n      className={`pt-4 relative ${className}`}\n      style={{ minHeight: '50px' }}\n    >\n      <div className=\"container hidden\">\n        <div className=\"row\">\n          <div className=\"offset-md-3 col-md-6\">\n            <div className=\"form-group files\">\n              <label>Upload Your File </label>\n              <input\n                type=\"file\"\n                id=\"common-upload-component\"\n                ref={uploadDomRef}\n                disabled={Boolean(disabled)}\n                className=\"form-control\"\n                accept=\"xls, xlsx\"\n                onChange={onChangeHandler}\n              />\n            </div>\n\n            {!autoUpload && (\n              <button\n                type=\"button\"\n                className=\"btn btn-success btn-block\"\n                onClick={() => onClickHandler()}\n              >\n                Upload\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n      {render(getUploadArea())}\n    </div>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}